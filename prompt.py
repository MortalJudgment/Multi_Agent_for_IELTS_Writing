from textwrap import dedent

class Band_description():
    def Coherence_and_Cohesion(self):
        return """An essay must fully fit the positive features of the descriptor at a particular level. 
        ## Logical Structure
        Band 9:
        The logical structure is sophisticated and easy to follow.
        The progression of ideas is seamless, making the message effortless to follow.
        Any minor lapses in the logical flow are extremely rare.
        Band 8:
        The logical structure is clear and easily understandable.
        Ideas and information are logically sequenced.
        Occasional lapses in the logical flow may occur but do not impede understanding.
        Band 7:
        The logical structure is clear with a coherent progression of ideas.
        A few minor lapses in logical flow may occur, but they do not significantly disrupt the reader's understanding.
        Overall organization supports the coherence of the response.
        Band 6:
        The logical structure is generally clear, with an overall progression of ideas.
        Some minor issues in the logical flow may be present due to misuse or overuse of cohesive devices.
        The organization is mostly coherent but may sometimes lack clarity.
        Band 5:
        There is an underlying logical structure, but it may not be wholly clear.
        The progression of ideas may be inconsistent.
        Organization may appear somewhat disjointed.
        Band 4:
        The logical structure is not clear, and the progression of ideas is lacking.
        Relationships between ideas may be inadequately marked or unclear.
        The overall organization may be difficult to follow.
        Band 3:
        There is little evidence of a logical structure.
        Ideas are discernible but difficult to relate to each other.
        Minimal use of cohesive devices to indicate logical relationships between ideas.
        Band 2:
        There is little to no logical structure.
        Ideas, if present, are scattered and not connected.
        Band 1:
        No logical structure is evident.
        The response fails to communicate any coherent message.
        Band 0:
        No attempt to answer or off-topic response.

        ## Introduction & Conclusion Present
        Band 9:
        Both introduction and conclusion are present and skillfully crafted.
        They effectively frame the essay, providing clear context and summary.
        Band 8:
        Both introduction and conclusion are present and clear.
        They effectively introduce and summarize the main points.
        Band 7:
        Both introduction and conclusion are generally present.
        They are clear and contribute to the overall coherence of the response.
        Band 6:
        Introduction and conclusion are present but may lack some clarity or effectiveness.
        They generally help in framing the essay but may not be fully effective.
        Band 5:
        Introduction and conclusion are present but may be underdeveloped or unclear.
        They provide some context but may not effectively frame the essay.
        Band 4:
        Introduction and/or conclusion may be missing or unclear.
        They do not effectively frame the essay.
        Band 3:
        Introduction and conclusion are likely missing or very unclear.
        There is little to no framing of the essay.
        Band 2:
        Introduction and conclusion are not present.
        There is no framing of the response.
        Band 1:
        No introduction or conclusion.
        Band 0:
        No attempt to answer or off-topic response.

        ## Supported Main Points
        Band 9:
        Main points are well-supported with relevant and effective examples or details.
        The support enhances the overall argument.
        Band 8:
        Main points are clearly supported with appropriate examples or details.
        The support is logical and adds to the coherence of the argument.
        Band 7:
        Main points are generally supported with relevant examples or details.
        Some minor lapses in support may occur but do not significantly affect the argument.
        Band 6:
        Main points are supported but the support may be somewhat general or occasionally lacking in relevance.
        The overall argument is generally clear but may have some gaps.
        Band 5:
        Main points have some support but it may be inadequate or not always relevant.
        The argument may be partially clear but lacks strong support.
        Band 4:
        Main points are present but are poorly supported.
        The argument is often unclear due to a lack of relevant support.
        Band 3:
        Main points are difficult to discern and lack proper support.
        The response lacks a clear argument.
        Band 2:
        Little to no support for main points.
        The response does not present a coherent argument.
        Band 1:
        No discernible main points or support.
        Band 0:
        No attempt to answer or off-topic response.

        ## Accurate Linking Words
        Band 9:
        Linking words are used accurately and naturally, rarely drawing attention.
        There are minimal or no errors in their use.
        Band 8:
        Linking words are used accurately and appropriately.
        There may be occasional minor errors but they do not impede understanding.
        Band 7:
        Linking words are used effectively with some inaccuracies.
        Their use supports the logical flow but may occasionally be overused or underused.
        Band 6:
        Linking words are used generally correctly but there may be some errors or overuse.
        Their use supports the overall cohesion but may sometimes be mechanical.
        Band 5:
        Linking words are used but there are frequent errors or overuse.
        Their use does not always support the coherence effectively.
        Band 4:
        Basic linking words are used but often inaccurately.
        Their use is repetitive or insufficient, affecting coherence.
        Band 3:
        Minimal use of linking words, often inaccurately.
        Their use does not effectively support coherence.
        Band 2:
        Little or no use of linking words.
        The response lacks coherence.
        Band 1:
        No use of linking words.
        Band 0:
        No attempt to answer or off-topic response.

        ## Variety in Linking Words
        Band 9:
        A wide variety of linking words is used skillfully.
        The variety enhances the overall coherence and flow.
        Band 8:
        A good variety of linking words is used effectively.
        Occasional lapses in variety may occur but do not affect overall coherence.
        Band 7:
        A range of linking words is used flexibly but with some inaccuracies or overuse.
        The variety generally supports coherence.
        Band 6:
        Some variety in linking words is evident but may be limited.
        The use is generally effective but may be somewhat mechanical.
        Band 5:
        Limited variety in linking words, with frequent repetition.
        The lack of variety affects the overall coherence.
        Band 4:
        Basic and repetitive use of linking words.
        There is little variety, affecting the coherence.
        Band 3:
        Minimal variety in linking words, often inaccurate.
        The response lacks coherence.
        Band 2:
        Little or no variety in linking words.
        The response is not coherent.
        Band 1:
        No variety in linking words.
        Band 0:
        No attempt to answer or off-topic response."""
    def Lexical_Resource(self):
        return """ An essay must fully fit the positive features of the descriptor at a particular level. 
        ## Varied Vocabulary
        Band 9:
        Demonstrates full flexibility and precise use of a wide range of vocabulary.
        Uses vocabulary accurately and appropriately with very natural and sophisticated control of lexical features.
        Minor errors in vocabulary usage are extremely rare and have minimal impact on communication.
        Band 8:
        Uses a wide range of vocabulary fluently and flexibly to convey precise meanings.
        Skillful use of uncommon and/or idiomatic items when appropriate, despite occasional inaccuracies in word choice and collocation.
        Occasional errors in vocabulary usage do not significantly impact communication.
        Band 7:
        Has sufficient vocabulary to allow some flexibility and precision.
        Some ability to use less common and/or idiomatic items.
        An awareness of style and collocation is evident, though some inappropriate word choices occur.
        Errors in vocabulary usage are few and do not detract from overall clarity.
        Band 6:
        Vocabulary is generally adequate and appropriate for the task.
        Meaning is generally clear despite a rather restricted range or a lack of precision in word choice.
        A wider range of vocabulary may be used if the writer takes risks, but this can lead to higher degrees of inaccuracy or inappropriacy.
        Band 5:
        Vocabulary is limited but minimally adequate for the task.
        Simple vocabulary may be used accurately, but the range does not permit much variation in expression.
        Frequent lapses in the appropriacy of word choice and a lack of flexibility are apparent in frequent simplifications and/or repetitions.
        Band 4:
        Vocabulary is limited and often inadequate for or unrelated to the task.
        Basic vocabulary may be used repetitively.
        Inappropriate use of lexical chunks (e.g., memorized phrases, formulaic language, and/or language from the input material) is common.
        Band 3:
        Vocabulary is inadequate, possibly due to the response being significantly underlength.
        Over-dependence on input material or memorized language is apparent.
        Control of word choice is very limited, and errors predominate, severely impeding meaning.
        Band 2:
        Vocabulary is extremely limited with few recognizable strings, apart from memorized phrases.
        There is no apparent control of word choice.
        Band 1:
        Responses of 20 words or fewer are rated at Band 1.
        No vocabulary resource is apparent, except for a few isolated words.
        Band 0:
        Should only be used where a candidate did not attend or attempt the question in any way, used a language other than English throughout, or where there is proof that a candidate’s answer has been totally memorized.

        ## Accurate Spelling & Word Formation
        Band 9:
        Minor errors in spelling and word formation are extremely rare and have minimal impact on communication.
        Band 8:
        Occasional errors in spelling and/or word formation may occur, but they have minimal impact on communication.
        Band 7:
        There are only a few errors in spelling and/or word formation, and they do not detract from overall clarity.
        Band 6:
        There are some errors in spelling and/or word formation, but these do not impede communication.
        Band 5:
        Errors in spelling and/or word formation may be noticeable and may cause some difficulty for the reader.
        Band 4:
        Inappropriate word choice and/or errors in word formation and/or in spelling may impede meaning.
        Band 3:
        Control of word choice and/or spelling is very limited, and errors predominate. These errors may severely impede meaning.
        Band 2:
        There is no apparent control of word formation and/or spelling.
        Band 1:
        Responses of 20 words or fewer are rated at Band 1.
        No resource is apparent, except for a few isolated words.
        Band 0:
        Should only be used where a candidate did not attend or attempt the question in any way, used a language other than English throughout, or where there is proof that a candidate's answer has been totally memorized."""
    def Grammatical_Range_and_Accuracy(self):
        return """An essay must fully fit the positive features of the descriptor at a particular level.
        ## Mix of Complex & Simple Sentences
        Band 9:
        A wide range of structures is used with full flexibility and control.
        Both simple and complex sentences are employed effortlessly and appropriately.
        Sentence structures are varied and sophisticated, demonstrating a high level of fluency and accuracy.
        Band 8:
        A wide range of structures is flexibly and accurately used.
        The majority of sentences are error-free, and there is a good balance of simple and complex sentences.
        Complex structures are used effectively and appropriately.
        Band 7:
        A variety of complex structures is used with some flexibility and accuracy.
        There is a good mix of simple and complex sentences, and complex structures are frequently used correctly.
        Errors in sentence structures do not impede communication.
        Band 6:
        A mix of simple and complex sentence forms is used, but flexibility is limited.
        Complex structures are attempted but may not be as accurately used as simple ones.
        Errors in sentence structures occur but rarely impede communication.
        Band 5:
        The range of structures is limited and rather repetitive.
        Complex sentences are attempted but tend to be faulty, with greater accuracy in simple sentences.
        Grammatical errors in complex sentences may cause some difficulty for the reader.
        Band 4:
        A very limited range of structures is used.
        Subordinate clauses and complex sentences are rare, with simple sentences predominating.
        Some accurate structures are produced, but grammatical errors are frequent and may impede meaning.
        Band 3:
        Sentence forms are attempted, but errors in grammar predominate, especially in complex sentences.
        Simple sentences may be more accurate, but overall control of sentence forms is lacking.
        Length may be insufficient to provide evidence of control of sentence forms.
        Band 2:
        There is little or no evidence of sentence forms, except in memorized phrases.
        Complex sentences are almost entirely absent.
        Band 1:
        Responses of 20 words or fewer are rated at Band 1.
        No rateable language is evident, and sentence structures are minimal.
        Band 0:
        Should only be used where a candidate did not attend or attempt the question in any way, used a language other than English throughout, or where there is proof that a candidate’s answer has been totally memorized.

        ## Clear and Correct Grammar
        Band 9:
        Punctuation and grammar are used appropriately throughout.
        Minor errors are extremely rare and have minimal impact on communication.
        There is full control over grammatical structures.
        Band 8:
        Grammar and punctuation are well managed, with the majority of sentences error-free.
        Occasional, non-systematic errors and inappropriacies occur but have minimal impact on communication.
        High level of grammatical accuracy is maintained.
        Band 7:
        Grammar and punctuation are generally well controlled.
        Error-free sentences are frequent, though a few grammatical errors may persist.
        These errors do not impede communication.
        Band 6:
        Errors in grammar and punctuation occur but rarely impede communication.
        There is generally adequate control of grammar, though complex structures may show more inaccuracies.
        Meaning is generally clear despite grammatical errors.
        Band 5:
        Grammatical errors may be frequent and cause some difficulty for the reader.
        Punctuation may be faulty.
        Accuracy is higher in simple sentences compared to complex ones.
        Band 4:
        Grammatical errors are frequent and may impede meaning.
        Punctuation is often faulty or inadequate.
        Some structures are produced accurately, but overall control is lacking.
        Band 3:
        Errors in grammar and punctuation predominate, except in memorized phrases or those taken from input material.
        These errors prevent most meaning from coming through.
        Control of grammatical structures is minimal.
        Band 2:
        There is little or no control of grammatical structures.
        Errors dominate, making communication very difficult.
        Band 1:
        Responses of 20 words or fewer are rated at Band 1.
        No rateable language is evident, and grammatical control is minimal.
        Band 0:
        Should only be used where a candidate did not attend or attempt the question in any way, used a language other than English throughout, or where there is proof that a candidate’s answer has been totally memorized.
        """
    def Task_Response(self):
        return """An essay must fully fit the positive features of the descriptor at a particular level. 
        ## Complete Response
        Band 9:
        The prompt is fully addressed and explored in depth.
        All parts of the task are comprehensively covered with detailed responses.
        Band 8:
        The prompt is appropriately and sufficiently addressed.
        Most parts of the task are covered in detail, with minimal omissions.
        Band 7:
        The prompt is appropriately and sufficiently addressed.
        Most parts of the task are covered, though there may be minor omissions.
        Band 6:
        The main parts of the prompt are addressed, though some may be more fully covered than others.
        Some elements of the task may be overlooked or covered superficially.
        Band 5:
        The main parts of the prompt are incompletely addressed.
        Several parts of the task may be missing or inadequately covered.
        Band 4:
        The prompt is tackled in a minimal way.
        Large parts of the task are missing or inadequately addressed.
        Band 3:
        No part of the prompt is adequately addressed.
        The response is largely off-topic or misunderstood.
        Band 2:
        The content is barely related to the prompt.
        Most of the task is not addressed.
        Band 1:
        Responses of 20 words or fewer are rated at Band 1.
        The content is wholly unrelated to the prompt.
        Band 0:
        No attempt to address the task, used a language other than English, or completely memorized answer.

        ## Clear & Comprehensive Ideas
        Band 9:
        A clear and fully developed position is presented.
        Ideas are relevant, fully extended, and well supported.
        Band 8:
        A clear and well-developed position is presented.
        Ideas are relevant, well extended, and supported.
        Band 7:
        A clear and well-developed position is presented.
        Ideas are relevant and extended with support, though occasional lapses may occur.
        Band 6:
        A position is presented that is directly relevant, but the conclusions may be unclear or repetitive.
        Main ideas are relevant but may lack clarity or sufficient development.
        Band 5:
        A position is expressed but development is not always clear.
        Main ideas are limited and may lack sufficient development or clarity.
        Band 4:
        A position is discernible but not clear without careful reading.
        Main ideas are difficult to identify and may lack relevance or support.
        Band 3:
        No relevant position can be identified.
        Few ideas are presented, and they are underdeveloped or irrelevant.
        Band 2:
        No position can be identified.
        Only glimpses of ideas are present without development.
        Band 1:
        Responses of 20 words or fewer are rated at Band 1.
        The content is wholly unrelated to the prompt.
        Band 0:
        No attempt to address the task, used a language other than English, or completely memorized answer.
        Relevant & Specific Examples
        Band 9:
        Examples are specific, relevant, and well integrated into the response.
        Examples effectively support the main ideas.
        Band 8:
        Examples are specific and relevant.
        Examples are well used to support the main ideas, with minimal lapses.
        Band 7:
        Examples are relevant and used to support ideas.
        There may be occasional lapses in the use of examples.
        Band 6:
        Examples are relevant but may lack specificity or be inadequately integrated.
        Some supporting arguments and evidence may be less relevant or inadequate.
        Band 5:
        Examples may be relevant but are often limited or insufficiently developed.
        There may be irrelevant details or repetition.
        Band 4:
        Examples are difficult to identify and may lack relevance or clarity.
        Supporting arguments and evidence are often inadequate.
        Band 3:
        Few examples are presented, and those that are may be irrelevant or insufficiently developed.
        Band 2:
        Only glimpses of examples are present, without development.
        Band 1:
        Responses of 20 words or fewer are rated at Band 1.
        The content is wholly unrelated to the prompt.
        Band 0:
        No attempt to address the task, used a language other than English, or completely memorized answer.

        ## Appropriate Word Count
        Yes: total words of essay approximately 250 to 280 words.
        No: total words of essay less than 250 words or more than 290 words"""


class ScoringPrompt():
    def Coherence_and_Cohesion(self):
        description = dedent("""\
                             To get better result in your answer, you should assess the essay's organization, logical flow, and use of linking words.
                             You should examine the essay's structure, ensuring it has a clear introduction and conclusion, well-supported main points, accurate linking words, and a variety of linking words.""")
        sub_criterias = dedent("""\
                               - Logical structure
                               - Introduction & conclusion present
                               - Supported main points
                               - Accurate linking words
                               - Variety in linking words""")
        
        return description, sub_criterias
    
    def Lexical_Resource(self):
        description = dedent("""\
                             To get better result in your answer, you should assess the essay's use of vocabulary.
                             You should examine the essay for varied vocabulary, accurate spelling, and word formation.""")
        sub_criterias = dedent("""\
                                - Varied vocabulary
                                - Accurate spelling & word formation""")
        
        return description, sub_criterias
    
    def Grammatical_Range_and_Accuracy(self):
        description = dedent("""\
                             To get better result in your answer, you should assess the essay's use of grammar and sentence structures.
                             You should examine the essay for a mix of complex and simple sentences, and clear and correct grammar.""")
        sub_criterias = dedent("""\
                                 - Mix of complex & simple sentences
                                 - Clear and correct grammar""")
        
        return description, sub_criterias

    def Task_Response(self):
        description = dedent("""\
                             To get better result in your answer, you should assess the essay's response to the prompt.
                             You should examine the essay for complete response, clear & comprehensive ideas, relevant & specific examples, and appropriate word count.""")
        sub_criterias = dedent("""\
                                 - Complete response
                                 - Clear & comprehensive ideas
                                 - Relevant & specific examples
                                 - Appropriate word count (DO NOT give score to this sub criterias. Return Yes or No)""")
        
        return description, sub_criterias

class RefinedOutput():
    def Coherence_and_Cohesion(self):
        return """Output Format:
        ### **Coherence and Cohesion** criteria
        ##### Sub-criterias score:
        1. **Logical structure**: (score)
        - Strong points: Identify reasons for strong logical structure.
        - Weak points: Identify reasons for weak logical structure.
        - *Improvement*: 
        
        2. **Introduction & conclusion present**: (score)
        - Strong points: Identify reasons for strong introduction and conclusion.
        - Weak points: Identify reasons for weak introduction and conclusion.
        - *Improvement*:

        3. **Supported main points**: (score)
        - Strong points: Identify reasons for strong support of main points.
        - Weak points: Identify reasons for weak support of main points.
        - *Improvement*: 

        4. **Accurate linking words**: (score)
        - Strong points: Identify reasons for accurate use of linking words.
        - Weak points: Identify reasons for inaccurate use of linking words.

        5. **Variety in linking words**: (score)
        - Strong points: Identify reasons for good variety in linking words.
        - Weak points: Identify reasons for poor variety in linking words.
        - *Improvement*: 

        **Coherence and Cohesion** criteria OVERALL band score: (score)
        
        ##### Feedback:
        -
        """
    def Lexical_Resource(self):
        return """Output Format:
        ### **Lexical Resource criteria**
        ##### Sub-criterias score:
        1. **Varied vocabulary**: (score)
        - Strong points: Identify reasons for strong varied vocabulary.
        - Weak points: Identify reasons for weak varied vocabulary.
        - *Improvement*: 
            
        2. **Accurate spelling & word formation**: (score)
        - Strong points: Identify reasons for accurate spelling & word formation.
        - Weak points: Identify reasons for inaccurate spelling & word formation.
        - *Improvement*: 

        **Lexical Resource** criteria OVERALL band score: (score)

        ##### Feedback:
        -
        """

    def Grammatical_Range_and_Accuracy(self):
        return """Output Format:
        ### **Grammatical Range and Accuracy criteria**
        ##### Sub-criterias score:
        1. **Mix of complex & simple sentences**: (score)
        - Strong points: Identify reasons for strong mix of complex & simple sentences.
        - Weak points: Identify reasons for weak mix of complex & simple sentences.
        - *Improvement*: 

        2. **Clear and correct grammar**: (score)
        - Strong points: Identify reasons for strong clear and correct grammar.
        - Weak points: Identify reasons for weak clear and correct grammar.
        - *Improvement*: 

        **Grammatical Range and Accuracy** criteria OVERALL band score: (score)

        ##### Feedback:
        -
        """

    def Task_Response(self):
        return """Output Format:
        ### Task Response criteria 
        ##### Sub-criterias score:
        1. **Complete response**: (score)
        - Strong points: Identify reasons for strong complete response.
        - Weak points: Identify reasons for weak complete response.
        - *Improvement*: 

        2. **Clear & comprehensive ideas**: (score)
        - Strong points: Identify reasons for strong clear & comprehensive ideas.
        - Weak points: Identify reasons for weak clear & comprehensive ideas.
        - *Improvement*: 
        
        3. **Relevant & specific examples**: (score)
        - Strong points: Identify reasons for strong relevant & specific examples.
        - Weak points: Identify reasons for weak relevant & specific examples.
        - *Improvement*:

        4. **Appropriate word count**: (score)
        - Strong points: Identify reasons for strong appropriate word count.
        - Weak points: Identify reasons for weak appropriate word count.
        - *Improvement*: 

        **Task Response** criteria OVERALL band score: (score)

        ##### Feedback:
        -
        """

class Output_Scoring():
    def Coherence_and_Cohesion(self):
        return """Output Format:
        1. **Logical structure**: (score)
        - Strong points: Identify reasons for strong logical structure.
        - Weak points: Identify reasons for weak logical structure.
        
        2. **Introduction & conclusion present**: (score)
        - Strong points: Identify reasons for strong introduction and conclusion.
        - Weak points: Identify reasons for weak introduction and conclusion.

        3. **Supported main points**: (score)
        - Strong points: Identify reasons for strong support of main points.
        - Weak points: Identify reasons for weak support of main points.

        4. **Accurate linking words**: (score)
        - Strong points: Identify reasons for accurate use of linking words.
        - Weak points: Identify reasons for inaccurate use of linking words.

        5. **Variety in linking words**: (score)
        - Strong points: Identify reasons for good variety in linking words.
        - Weak points: Identify reasons for poor variety in linking words.

        **Coherence and Cohesion** criteria OVERALL band score: (score)
        """
    def Lexical_Resource(self):
        return """Output Format:
        1. **Varied vocabulary**: (score)
        - Strong points: Identify reasons for strong varied vocabulary.
        - Weak points: Identify reasons for weak varied vocabulary.
            
        2. **Accurate spelling & word formation**: (score)
        - Strong points: Identify reasons for accurate spelling & word formation.
        - Weak points: Identify reasons for inaccurate spelling & word formation.

        **Lexical Resource** criteria OVERALL band score: (score)
        """

    def Grammatical_Range_and_Accuracy(self):
        return """Output Format:
        1. **Mix of complex & simple sentences**: (score)
        - Strong points: Identify reasons for strong mix of complex & simple sentences.
        - Weak points: Identify reasons for weak mix of complex & simple sentences.

        2. **Clear and correct grammar**: (score)
        - Strong points: Identify reasons for strong clear and correct grammar.
        - Weak points: Identify reasons for weak clear and correct grammar.

        **Grammatical Range and Accuracy** criteria OVERALL band score: (score)
        """

    def Task_Response(self):
        return """Output Format:
        1. **Complete response**: (score)
        - Strong points: Identify reasons for strong complete response.
        - Weak points: Identify reasons for weak complete response.

        2. **Clear & comprehensive ideas**: (score)
        - Strong points: Identify reasons for strong clear & comprehensive ideas.
        - Weak points: Identify reasons for weak clear & comprehensive ideas.
        
        3. **Relevant & specific examples**: (score)
        - Strong points: Identify reasons for strong relevant & specific examples.
        - Weak points: Identify reasons for weak relevant & specific examples.

        4. **Appropriate word count**: (score)
        - Strong points: Identify reasons for strong appropriate word count.
        - Weak points: Identify reasons for weak appropriate word count.

        **Task Response** criteria OVERALL band score: (score)        
        """
